import{h}from"../app.core.js";var SocketIoService=function(){function t(e){if(this.lib=!1,t.instance)throw new Error("Error - use SocketIoService.getInstance()");this.path=e,this.attachLibrary()}return t.getInstance=function(e){return void 0===e&&(e="/assets/lib/socket.io.js"),t.instance=t.instance||new t(e)},t.prototype.attachLibrary=function(){if(!this.lib){var t=document.createElement("script");t.src=this.path,document.querySelector("head").appendChild(t),this.ensureIoPresent().then(function(){this._io=window.io,this._socket=this._io("http://localhost:3000"),this.lib=!0}.bind(this))}},t.prototype.ensureIoPresent=function(){var t=function(e){if(void 0!==window.io)return e();setTimeout(t,30,e)};return new Promise(function(e){t(e)}.bind(this))},t.prototype.ensureSocketPresent=function(){var t=this,e=function(n){if(void 0!==t._socket)return n();setTimeout(e,30,n)};return new Promise(function(t){e(t)}.bind(this))},t.prototype.onSocketReady=function(t){return this.ensureIoPresent().then(function(){t()}.bind(this))},t.prototype.onSocket=function(t,e){this.ensureSocketPresent().then(function(){this._socket.on(t,e)}.bind(this))},t.prototype.emitSocket=function(t,e){console.log(t,e),this.ensureSocketPresent().then(function(){this._socket.emit(t,e)}.bind(this))},t.prototype.socket=function(){return this._socket},t}(),AppRoot=function(){function t(){this._socketService=SocketIoService.getInstance(this.service_url),this.list=[]}return t.prototype.componentWillLoad=function(){var t=this;fetch("http://"+this.service_url+":3000/subscription?entity="+this.type+"&id="+this.id).then(function(t){return t.json()}).then(function(e){t.list=JSON.parse(JSON.stringify(e)).entities})},t.prototype.componentDidLoad=function(){var t=this;this._socketService.onSocketReady(function(){t._socketService.onSocket(t.type+"-"+t.id,function(e){t.list=JSON.parse(JSON.stringify(e)).entities})})},t.prototype.render=function(){return h("div",null,h("header",null,h("h1",null,"Stencil App Starter")),h("main",null,h("ul",{class:"list-group"},this.list.map(function(t){return h("li",{class:"list-group-item active"},h("div",{class:"md-v-line"}),h("i",{class:"fas fa-laptop mr-4 pr-3"}),t.name," - (",t.values.map(function(t){return h("span",null,t.name,": ",t.value,", ")}),")")}))))},Object.defineProperty(t,"is",{get:function(){return"app-root"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{id:{type:String,attr:"id"},list:{state:!0},service_url:{type:String,attr:"service_url"},type:{type:String,attr:"type"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"header{background:#5851ff;height:56px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26)}h1,header{color:#fff}h1{font-size:1.4rem;font-weight:500;padding:0 12px}.md-v-line{position:absolute;border-left:1px solid rgba(0,0,0,.125);height:50px;top:0;left:54px}"},enumerable:!0,configurable:!0}),t}();export{AppRoot};