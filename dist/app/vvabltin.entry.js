const t=window.App.h;class e{constructor(t){if(this.lib=!1,e.instance)throw new Error("Error - use SocketIoService.getInstance()");this.path=t,this.attachLibrary()}static getInstance(t="dist/collection/assets/lib/socket.io.js"){return e.instance=e.instance||new e(t),e.instance}attachLibrary(){if(!this.lib){const t=document.createElement("script");t.src=this.path,document.querySelector("head").appendChild(t),this.ensureIoPresent().then(function(){this._io=window.io,this._socket=this._io("http://localhost:3000"),this.lib=!0}.bind(this))}}ensureIoPresent(){const t=e=>{if(void 0!==window.io)return e();setTimeout(t,30,e)};return new Promise(function(e){t(e)}.bind(this))}ensureSocketPresent(){const t=e=>{if(void 0!==this._socket)return e();setTimeout(t,30,e)};return new Promise(function(e){t(e)}.bind(this))}onSocketReady(t){return this.ensureIoPresent().then(function(){t()}.bind(this))}onSocket(t,e){this.ensureSocketPresent().then(function(){this._socket.on(t,e)}.bind(this))}emitSocket(t,e){console.log(t,e),this.ensureSocketPresent().then(function(){this._socket.emit(t,e)}.bind(this))}socket(){return this._socket}}class i{constructor(){this._socketService=e.getInstance(),this.list=[],this.listo=[],this.lista=[]}componentWillLoad(){fetch("http://"+this.service_url+":3000/subscription?entity="+this.type+"&id="+this.entityid).then(t=>t.json()).then(t=>{this.list=JSON.parse(JSON.stringify(t)).entities,this.list[0].values.map(t=>{console.log(t.name),console.log(t.value),t.name==this.data_to_compare&&(this.listo.push(parseInt(t.value)),console.log(this.listo),this.lista.push((new Date).getTime()))})})}componentDidLoad(){this._socketService.onSocketReady(()=>{this._socketService.onSocket(this.type+"-"+this.entityid,t=>{this.list=JSON.parse(JSON.stringify(t)).entities,this.list[0].values.map(t=>{t.name==this.data_to_compare&&(this.listo.push(t.value),this.lista.push((new Date).getTime()))})})})}render(){return t("div",null,t("apex-chart",{type:"line",width:"100%",height:"300px",series:[{name:this.data_to_compare,data:this.listo}],options:{xaxis:{categories:this.lista,type:"datetime",range:3e3,labels:{datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm"}}},chart:{animations:{enabled:!0,easing:"linear",dynamicAnimation:{enabled:!0,speed:500},zoom:{enabled:!1}},toolbar:{show:!1}},stroke:{curve:"smooth"}}}))}static get is(){return"app-realChart"}static get encapsulation(){return"shadow"}static get properties(){return{data_to_compare:{type:String,attr:"data_to_compare"},entityid:{type:String,attr:"entityid"},list:{state:!0},lista:{state:!0},listo:{state:!0},service_url:{type:String,attr:"service_url"},type:{type:String,attr:"type"}}}static get style(){return""}}export{i as AppRealchart};